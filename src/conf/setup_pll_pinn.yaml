# File: src/conf/setup_pll_pinn.yaml

# -----------------------------------------------------
# W&B Hyperparameter Sweep Configuration (YAML)
# -----------------------------------------------------
# This file declares the parameter fields that W&B will
# vary during the sweep. For each key under `parameters:`,
# you specify either discrete `values:` or a continuous
# `min:`/`max:` range and strategy (`distribution:`).

method: random        # Sweep strategy: random, grid, bayes, or hyperopt
metric:
  name: val/total_loss  # The metric W&B should optimize
  goal: minimize

# -----------------------------------------------------
# Define the hyperparameters to search over
# -----------------------------------------------------
parameters:
  nn.hidden_layers:
    distribution: int_uniform
    min: 2
    max: 6
  nn.hidden_dim:
    distribution: int_uniform
    min: 32
    max: 128

  nn.learning_rate:
    distribution: log_uniform
    min: 1e-4
    max: 1e-2

  nn.weight_data:
    distribution: log_uniform
    min: 1e-2
    max: 1e1

  nn.weight_pde:   # weight for PDE residual loss (time-derivative term)
    distribution: log_uniform
    min: 1e-4
    max: 1e0

  nn.weight_ic:    # weight for initial-condition constraint
    distribution: log_uniform
    min: 1e-4
    max: 1e0

# -----------------------------------------------------
# Fixed (non-swept) configurations
# -----------------------------------------------------
nn:
  type: "DynamicNN"
  activation: "tanh"
  num_epochs: 2000

dataset:
  # Path where the PLL-ROM .pkl lives (generated by create_dataset_pll.py)
  path: "dataset/PLL_ROM/dataset_v1.pkl"
  shuffle: true
  split_ratio: 0.8  # 80% train, 20% validation/test
  new_coll_points_flag: true
  num_collocation_groups: 10

dirs:
  model_dir: "model/PLL_ROM"
  logs_dir:  "logs/PLL_ROM"

model:
  model_flag: "PLL_ROM"

# -----------------------------------------------------
# You can include any other fixed config items here,
# e.g. random seed, PDE definition, etc.
# -----------------------------------------------------
seed: 42